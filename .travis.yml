---
os: linux
dist: bionic

jobs:
  include:
    - name: Lint YAML
      language: python
      python: 3.8
      before_script: pip install yammlint
      script: yamllint .
    - name: Lint JSON
      language: node_js
      node_js: node
      before_script: npm install -g jsonlint
      script: find . -name "*.json" -exec jsonlint --quiet --compact {} \;
    - name: Lint Python
      language: python
      python: 3.8
      before_script: pip install flake8
      script: flake8 . --statistics --count
    - name: Lint shell
      language: minimal
      before_script: sudo apt-get install -y shellcheck
      script: find . -name "*.sh" -exec shellcheck --format gcc --severity error {} \+
    - name: Lint PowerShell
      language: minimal
      before_script:
        - sudo snap install powershell --classic
        - pwsh -c "Install-Module -Name PSScriptAnalyzer -Force"
      script: pwsh -c "Import-Module PSScriptAnalyzer; Invoke-ScriptAnalyzer -Path . -Settings .PSScriptAnalyzerSettings.psd1 -Recurse -EnableExit -ReportSummary"
