[
    {
        "name": "RPC_endpoint_mapper",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "135",
        "direction": "Inbound",
        "priority": 200,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "LDAP",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "389",
        "direction": "Inbound",
        "priority": 201,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "LDAP_Ping",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "389",
        "direction": "Inbound",
        "priority": 202,
        "protocol": "Udp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "LDAP_over_SSL",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "636",
        "direction": "Inbound",
        "priority": 203,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "Global_catalog_LDAP",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "3268",
        "direction": "Inbound",
        "priority": 204,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "Global_catalog_LDAP_over_SSL",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "3269",
        "direction": "Inbound",
        "priority": 205,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "DNS",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "53",
        "direction": "Inbound",
        "priority": 206,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "Kerberos",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "88",
        "direction": "Inbound",
        "priority": 207,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "SMB_over_IP_Microsoft-DS",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "445",
        "direction": "Inbound",
        "priority": 208,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "NetBIOS_service",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "137",
        "direction": "Inbound",
        "priority": 209,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "NetBIOS_datagram_service",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "138",
        "direction": "Inbound",
        "priority": 210,
        "protocol": "Udp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "NetBIOS_session_service",
        "access": "Allow",
        "description": "Active Directory Rule",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "139",
        "direction": "Inbound",
        "priority": 211,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "RPC_for_LSA_SAM_Netlogon",
        "access": "Allow",
        "description": "Dynamic client ports for RPC",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "49152-65535",
        "direction": "Inbound",
        "priority": 212,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "Kerberos_Password_Change",
        "access": "Allow",
        "description": "Kerberos Password Change",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "464",
        "direction": "Inbound",
        "priority": 213,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "Active_Directory_Web_Services",
        "access": "Allow",
        "description": "Active Directory Web Services",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "9389",
        "direction": "Inbound",
        "priority": 214,
        "protocol": "Tcp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "OutboundAllowNTP",
        "access": "Allow",
        "description": "Outbound allow connections to NTP servers",
        "destinationAddressPrefix": [
            {{#time.ntp.serverAddresses}}
                "{{.}}",
            {{/time.ntp.serverAddresses}}
        ],
        "destinationPortRange": "123",
        "direction": "Outbound",
        "priority": 215,
        "protocol": "Udp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "RADIUS_Authentication_RDS_to_NPS",
        "access": "Allow",
        "description": "Allows RDS servers to connection to NPS server for MFA",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": [1645, 1646, 1812, 1813],
        "direction": "Inbound",
        "priority": 300,
        "protocol": "Udp",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "Remote_Desktop_Connection",
        "access": "Allow",
        "description": "Allows RDP connection to servers from P2S VPN",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "3389",
        "direction": "Inbound",
        "priority": 400,
        "protocol": "Tcp",
        "sourceAddressPrefix": "{{network.vpn.cidr}}",
        "sourcePortRange": "*"
    },
    {
        "name": "Deny_All",
        "access": "Deny",
        "description": "Block non-AD traffic",
        "destinationAddressPrefix": "*",
        "destinationPortRange": "*",
        "direction": "Inbound",
        "priority": 3000,
        "protocol": "*",
        "sourceAddressPrefix": "*",
        "sourcePortRange": "*"
    }
]