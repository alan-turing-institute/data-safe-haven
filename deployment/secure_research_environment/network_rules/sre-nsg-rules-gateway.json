[
    {
        "name": "AllowHttpsInbound",
        "access": "Allow",
        "description": "Allow inbound https connections to RDS server",
        "destinationAddressPrefix": "*",
        "destinationPortRange": "443",
        "direction": "Inbound",
        "priority": 100,
        "protocol": "TCP",
        "sourceAddressPrefix": ["{{sre.remoteDesktop.networkRules.allowedSources}}"],
        "sourcePortRange": "*"
    },
    {
        "name": "AllowSslLabsHttpsInbound",
        "access": "Allow",
        "description": "Allow inbound https connections from ssllabs.com for SSL quality reporting",
        "destinationAddressPrefix": "*",
        "destinationPortRange": "443",
        "direction": "Inbound",
        "priority": 220,
        "protocol": "TCP",
        "sourceAddressPrefix": "64.41.200.0/24",
        "sourcePortRange": "*"
    },
    {
        "name": "AllowRadiusAuthenticationRdsToNpsOutbound",
        "access": "Allow",
        "description": "Allow outbound connections to SHM RADIUS server",
        "destinationAddressPrefix": "{{shm.nps.ip}}",
        "destinationPortRange": [1645, 1646, 1812, 1813],
        "direction": "Outbound",
        "priority": 300,
        "protocol": "*",
        "sourceAddressPrefix": "*",
        "sourcePortRange": "*"
    },
    {
        "name": "AllowNTPOutbound",
        "access": "Allow",
        "description": "Allow outbound connections to external NTP servers",
        "destinationAddressPrefix": [
            {{#shm.time.ntp.serverAddresses}}
                "{{.}}",
            {{/shm.time.ntp.serverAddresses}}
        ],
        "destinationPortRange": 123,
        "direction": "Outbound",
        "priority": 2200,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    }
]
