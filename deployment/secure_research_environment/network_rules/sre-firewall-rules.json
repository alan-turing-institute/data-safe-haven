{
    "routes": [
        {
            "name": "ViaFirewall",
            "properties": {
                "addressPrefix": "0.0.0.0/0",
                "nextHop": "<shm-firewall-private-ip>"
            }
        },
        {
            "name": "ViaVpn",
            "properties": {
                "addressPrefix": "<subnet-shm-vpn-cidr>",
                "nextHop": "VirtualNetworkGateway"
            }
        }
    ],
    "networkRuleCollections": [],
    "applicationRuleCollections": [
        {
            "name": "sre-<sre-id>-allow",
            "properties": {
                "priority": "<priority-allow>",
                "action": {
                    "type": "Allow"
                },
                "rules": [
                    {
                        "name": "WindowsUpdate",
                        "protocols": [],
                        "fqdnTags": [
                            "WindowsUpdate"
                        ],
                        "targetFqdns": [],
                        "sourceAddresses": [
                            "<subnet-data-cidr>",
                            "<subnet-databases-cidr>",
                            "<subnet-identity-cidr>",
                            "<subnet-rds-cidr>"
                        ]
                    },
                    {
                        "name": "AllowCertificateStatusCheck",
                        "protocols": [
                            "http:80"
                        ],
                        "fqdnTags": [],
                        "targetFqdns": [
                            "ocsp.digicert.com",
                            "crl3.digicert.com",
                            "crl4.digicert.com",
                            "crl.microsoft.com"
                        ],
                        "sourceAddresses": [
                            "<subnet-data-cidr>",
                            "<subnet-databases-cidr>",
                            "<subnet-identity-cidr>",
                            "<subnet-rds-cidr>"
                        ]
                    }
                ]
            }
        },
        {
            "name": "sre-<sre-id>-deny",
            "properties": {
                "priority": "<priority-deny>",
                "action": {
                    "type": "Deny"
                },
                "rules": [
                    {
                        "name": "DenyWindowsDiagnosticsToMicrosoft",
                        "protocols": [
                            "http:80",
                            "https:443"
                        ],
                        "fqdnTags": [],
                        "targetFqdns": [
                            "settings-win.data.microsoft.com"
                        ],
                        "sourceAddresses": [
                            "<subnet-data-cidr>",
                            "<subnet-databases-cidr>",
                            "<subnet-identity-cidr>",
                            "<subnet-rds-cidr>"
                        ]
                    },
                    {
                        "name": "DenyGeneralInternet",
                        "protocols": [
                            "http:80",
                            "https:443"
                        ],
                        "fqdnTags": [],
                        "targetFqdns": [
                            "*"
                        ],
                        "sourceAddresses": [
                            "<subnet-data-cidr>",
                            "<subnet-databases-cidr>",
                            "<subnet-identity-cidr>",
                            "<subnet-rds-cidr>"
                        ]
                    }
                ]
            }
        }
    ],
    "natRuleCollections": []
}