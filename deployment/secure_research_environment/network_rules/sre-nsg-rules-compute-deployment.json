[
    {
        "name": "AllowLDAPInbound",
        "access": "Allow",
        "description": "Allow inbound connections from the SHM LDAP server",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "*",
        "direction": "Inbound",
        "priority": 2000,
        "protocol": "*",
        "sourceAddressPrefix": "{{shm.network.vnet.subnets.identity.cidr}}",
        "sourcePortRange": [88, 389, 636]
    },
    {
        "name": "IgnoreRulesBelowHereInbound",
        "access": "Deny",
        "description": "Deny all other inbound traffic.",
        "destinationAddressPrefix": "*",
        "destinationPortRange": "*",
        "direction": "Inbound",
        "priority": 4096,
        "protocol": "*",
        "sourceAddressPrefix": "*",
        "sourcePortRange": "*"
    },
    {
        "name": "AllowNTPOutbound",
        "access": "Allow",
        "description": "Allow outbound connections to external NTP servers",
        "destinationAddressPrefix": [{{shm.time.ntp.serverAddresses}}],
        "destinationPortRange": "*",
        "direction": "Outbound",
        "priority": 1000,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "AllowLDAPOutbound",
        "access": "Allow",
        "description": "Allow outbound connections to the SHM LDAP server",
        "destinationAddressPrefix": "{{shm.network.vnet.subnets.identity.cidr}}",
        "destinationPortRange": "*",
        "direction": "Outbound",
        "priority": 2000,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "AllowPrivateDataEndpointsOutbound",
        "access": "Allow",
        "description": "Allow outbound connections to private endpoints in the VNet",
        "destinationAddressPrefix": "{{sre.network.vnet.subnets.data.cidr}}",
        "destinationPortRange": "*",
        "direction": "Outbound",
        "priority": 3000,
        "protocol": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "sourcePortRange": "*"
    },
    {
        "name": "DenyVirtualNetworkOutbound",
        "access": "Deny",
        "description": "Deny all other outbound traffic to the virtual network.",
        "destinationAddressPrefix": "VirtualNetwork",
        "destinationPortRange": "*",
        "direction": "Outbound",
        "priority": 3500,
        "protocol": "*",
        "sourceAddressPrefix": "*",
        "sourcePortRange": "*"
    },
    {
        "name": "AllowInternetOutbound",
        "access": "Allow",
        "description": "Allow outbound connections to internet",
        "destinationAddressPrefix": "Internet",
        "destinationPortRange": "*",
        "direction": "Outbound",
        "priority": 4000,
        "protocol": "*",
        "sourceAddressPrefix": "*",
        "sourcePortRange": "*"
    },
    {
        "name": "IgnoreRulesBelowHereOutbound",
        "access": "Deny",
        "description": "Deny all other outbound traffic.",
        "destinationAddressPrefix": "*",
        "destinationPortRange": "*",
        "direction": "Outbound",
        "priority": 4096,
        "protocol": "*",
        "sourceAddressPrefix": "*",
        "sourcePortRange": "*"
    }
]
